function createSetIconAction(e,t){var n=document.createElement("canvas"),o=n.getContext("2d"),a=new Image;a.onload=function(){o.drawImage(a,0,0,19,19);var e=o.getImageData(0,0,19,19),n=new chrome.declarativeContent.SetIcon({imageData:e});t(n)},a.src=chrome.runtime.getURL(e)}function loadConditions(e){chrome.storage.sync.get("whitelist",function(t){var n=[];t.whitelist&&t.whitelist.forEach(function(e){var t=new chrome.declarativeContent.PageStateMatcher({pageUrl:{urlContains:e.URL}});n.push(t)}),e(n)})}function updateRules(){chrome.declarativeContent.onPageChanged.removeRules(void 0,function(){loadConditions(function(e){createSetIconAction("icons/true/wlist_true.png",function(t){chrome.declarativeContent.onPageChanged.addRules([{conditions:e,actions:[t]}])})})})}chrome.runtime.onMessage.addListener(function(e,t,n){"whitelist.uploaded"==e.greeting&&updateRules()}),chrome.runtime.onInstalled.addListener(function(){updateRules()});